<!DOCTYPE html>
<!--[if IE 7 ]><html class="ie7" lang="en"><![endif]-->
<!--[if IE 8 ]><html class="ie8" lang="en"><![endif]-->
<!--[if lte IE 9 ]><html class="ie9" lang="en"><![endif]-->
<!--[if !(IE)]><!--><html lang="en"><!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>SyPy &ndash; Sydney Python</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Sydney's Python User Group: first Thursday of every month. Hacknight on the Third Tuesday of each month.">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,500' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/style.css?v=2014-01-21">
	<!--[if lte IE 8 ]><script src="js/html5shiv.js"></script><![endif]-->
	
<script type="text/javascript" src="./brython/brython.js"></script>

<style>
div,
textarea {
    width:98%;
    height:100%;
}
.codeArea {
  overflow: auto;
  background-color: #000000;
  color: #ffffff;
  font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 
      'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;
  font-size: 14px;
}
</style>

	
</head>
<body onload="brython(1)"><!-- remove the 1 to leave debug mode -->

	<div class="primary-container">
		<header>
			<h1>
				SyPy
			</h1>
			<img src="images/monty-python-image.jpg">
		</header>
		<section class="sydney-python">
			<h1>Sydney Python</h1>
			<p>
				<strong>
					First Thursday of each month.
				</strong>
			</p>
			<p>
				<a href="//maps.google.com/?q=Level+6,+341+George+St,+Sydney,+2000">
					Level 6, 341 George St, Sydney. Atlassian
				</a>
			</p>
			<p> Attend the next meeting<br/>
				<a href="//sypy.eventbrite.com/">
				 eventbrite	
				</a> or <a href="http://www.meetup.com/sydneypython/">meetup</a>
			</p>
		</section>
		<section class="hacknight">
			<h1>Hacknight</h1>
			<p>
				<strong>Third Tuesday of each month.</strong>
			</p>
			<p>
				 <a href="//maps.google.com/?q=Hotel+Sweeney's,+236+Clarence+St,+Sydney+2000">
					Level 1, Hotel Sweeney''s, cnr Clarance and Druitt (opp town hall)
				</a> 
			</p>
			<p>
					Attend the next meeting<br/>
				<a href="http://sypyhack.eventbrite.com.au">eventbrite
				</a>
				or <a href="http://www.meetup.com/sydneypython/events/180218032/">meetup</a>
			</p>
			<h1>SyDjango</h1>
			<p>
				<strong>Forth thursday of each month.</strong>
			</p>
			<p>
					Attend the next meeting <br/>
					<a href="http://www.meetup.com/SyDjango/">meetup</a>
			</p>
			<h1>Mailing List</h1>
			<p>
				<a href="//groups.google.com/forum/#!forum/sydneypython">
					Join the discussion
				</a>
			</p>
			<h1>Twitter</h1>
			<p>
				<a href="https://twitter.com/sydneypython">
					@sydneypython
				</a>
				<a href="https://twitter.com/search?q=%23sypy&src=sypy.org">
					#sypy
				</a>
			</p>
		</section>
		<section class="mailing-list">
<textarea id="code" class="codeArea" rows=20></textarea>

<div id="content"></div>

<script type="text/python3">
import sys
import traceback

from browser import doc, win

history = []
current = 0

def write(data):
    doc['code'].value += data

sys.stdout.write = sys.stderr.write = write

_status = "main" # or "block" if typing inside a block

def cursorToEnd(*args):
    pos = len(doc['code'].value)
    doc['code'].setSelectionRange(pos,pos)

def get_col(area):
    # returns the column num of cursor
    sel = doc['code'].selectionStart
    lines = doc['code'].value.split('\n')
    for line in lines[:-1]:
        sel -= len(line)+1
    return sel

def myKeyPress(event):
    global _status,current
    
    if event.keyCode == 9: # tab key
        event.preventDefault()
        doc['code'].value += "    "
    elif event.keyCode == 13:    # return
        src = doc['code'].value
        if _status == "main":
            currentLine = src[src.rfind('>>>')+4:]
        elif _status == "3string":
            currentLine = src[src.rfind('>>>')+4:]
            currentLine = currentLine.replace('\n... ','\n')
        else:
            currentLine = src[src.rfind('...')+4:]

        if _status == 'main' and not currentLine.strip():
            doc['code'].value += '\n>>> '
            event.preventDefault()
            return
        doc['code'].value+='\n'
        history.append(currentLine)
        current += 1
        if _status == "main" or _status == "3string":
            try:
                _ = exec(currentLine,globals())
                if _ is not None:
                    print(repr(_))
                doc['code'].value += '>>> '
                _status = "main"
            except IndentationError:
                doc['code'].value += '... '
                _status = "block"
            except SyntaxError as msg:
                if str(msg) == 'invalid syntax : triple string end not found' or\
                    str(msg).startswith('Unbalanced bracket'):
                    doc['code'].value += '... '
                    _status = "3string"
                else:
                    traceback.print_exc()
                    doc['code'].value += '>>> '
                    _status = "main"
            except:
                traceback.print_exc()
                doc['code'].value += '>>> '
                _status = "main"
        elif currentLine == "": # end of block
            block = src[src.rfind('>>>')+4:].splitlines()
            block = [block[0]]+[b[4:] for b in block[1:]]
            block_src = '\n'.join(block)
            _status = "main"
            try:
                _ = exec(block_src,globals())
                if _ is not None:
                    print(repr(_))
            except:
                traceback.print_exc()
            doc['code'].value += '>>> '
        else:
            doc['code'].value += '... '        
        cursorToEnd()
        event.preventDefault()
        #event.stopPropagation()

def myKeyDown(event):
    global _status,current
    
    if event.keyCode == 37: # left arrow
        sel = get_col(doc['code'])
        if sel<5:
            event.preventDefault()
            event.stopPropagation()
    elif event.keyCode == 36: # line start
        pos = doc['code'].selectionStart
        col = get_col(doc['code'])
        doc['code'].setSelectionRange(pos-col+4,pos-col+4)
        event.preventDefault()
    elif event.keyCode == 38: # up
        if current > 0:
            pos = doc['code'].selectionStart
            col = get_col(doc['code'])
            # remove current line
            doc['code'].value = doc['code'].value[:pos-col+4]
            current -= 1
            doc['code'].value += history[current]
        event.preventDefault()
    elif event.keyCode == 40: # down
        if current < len(history)-1:
            pos = doc['code'].selectionStart
            col = get_col(doc['code'])
            # remove current line
            doc['code'].value = doc['code'].value[:pos-col+4]
            current += 1
            doc['code'].value += history[current]
        event.preventDefault()
    elif event.keyCode == 8: # backspace
        src = doc['code'].value
        lstart = src.rfind('\n')
        if (lstart==-1 and len(src)<5) \
            or (len(src)-lstart<6):
                event.preventDefault()
                event.stopPropagation()

doc['code'].bind('keypress', myKeyPress)
doc['code'].bind('keydown', myKeyDown)
doc['code'].bind('click', cursorToEnd)
v = sys.implementation.version
    
doc['code'].value = "Brython %s.%s [%s] on %s %s\n>>> " %(v[0],v[1],v[2],
    win.navigator.appName,win.navigator.appVersion)
doc['code'].focus()
cursorToEnd()

#def show_status(ev):
#    alert(_status)
#
#doc['show_status'].bind('click', show_status)


code = """
from datetime import datetime
import calendar
import math

now = datetime.now()
year, month = (now.year, now.month)

day = calendar.monthcalendar(now.year, now.month)[0][3]

if now.day > day:
    year, month = int(2014+math.floor(11/12)), now.month % 12
    day = calendar.monthcalendar(year, month)[0][3]

print("Next Sypy is %s" % datetime(year, month, day, 18, 30))
"""

print(code)
print(exec(code))

#TODO: print above code to the console + result



write("print('hello')")


</script>	
	
		</section>
		<div class="clear"></div>
	</div>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		ga('create', 'UA-41328058-1', 'sypy.org');
		ga('send', 'pageview');
	</script>



<p><i>Want to make this website better? do so at <a href="https://github.com/SyPy/sypy.github.com/blob/master/README.md">github</a>  </i></p>
	
	
</body>
</html>
